# 오렌지 질병 분류 성능 비교 연구

## 프로젝트 목표

이 프로젝트는 오렌지 이미지를 분석하여 질병 여부와 종류를 정확하게 판별하는 것을 목표로 한다. 기존의 수작업 방식은 시간과 비용이 많이 들기 때문에, 이미지 기반 자동 분류를 통해 효율성을 높이고자 한다.

## 분류 대상 질병

연구에서 다루는 오렌지 질병은 다음과 같으며, 이들은 시각적으로 뚜렷한 특징을 가지고 있다.

* **Citrus Black Spot:** 과일 표면에 검거나 갈색의 불규칙한 반점을 형성한다.
* **Citrus Canker:** 잎, 줄기, 과일에 코르크 모양의 융기된 병변이 나타나며, 주로 병변 주변에 황색 테두리가 있다.
* **Citrus Greening Disease (HLB):** 잎이 황색으로 변하는 황화 현상이 두드러지며, 과일의 색과 맛, 과즙에도 영향을 미친다.

## 사용 모델

특징 추출 및 분류를 위해 VGG와 ResNet, 두 가지 사전 학습 모델을 사용했다.

* **VGG 모델:**

    * ImageNet 데이터를 기반으로 하며, 깊은 네트워크 구조를 통해 높은 정확도를 얻을 수 있다.
    * 작은 크기의 컨볼루션 필터를 사용하여 파라미터 수를 줄였다.
    * VGG16 모델은 이미지 분류 및 객체 탐지에서 좋은 성능을 보인다.
    * 하지만 학습 시간이 오래 걸리고, 깊은 네트워크 층으로 인해 기울기 소실 문제가 발생할 수 있다.
* **ResNet 모델:**

    * VGG 모델의 기울기 소실 문제를 해결하기 위해 개발되었다.
    * 'Skip connection'이라는 구조를 사용하여, 기울기가 앞쪽 레이어로 직접 전달될 수 있도록 했다.
    * 이를 통해 깊은 레이어 구조에서도 학습이 가능하도록 했다.

## 데이터셋 구성

오렌지 질병 분류 데이터셋은 다음과 같이 구성되어 있다.

* **클래스:** 정상(fresh), Citrus Canker, Citrus Black Spot, Citrus Greening Disease의 4가지 클래스로 나뉜다.
* **데이터 비율:** 학습 데이터와 테스트 데이터는 약 10:1 비율로 분리되어 있다.
* **학습 데이터:** 총 991개로, 클래스별 분포는 비교적 불균일하다.
* **테스트 데이터:** 총 99개로, 클래스별 데이터 분포는 학습 데이터에 비해 균일하다.
* **이미지 형식:** 질병 데이터는 800x800 크기의 .jpg 파일인 반면, 정상 데이터는 크기가 다양하고 .png 파일이다.

| 클래스     | 학습 데이터셋 | 테스트 데이터셋 |
| :--------- | :------------- | :------------- |
| fresh      | 281개 (28.35%)  | 33개 (33.33%)   |
| blackspot  | 184개 (18.57%)  | 22개 (22.22%)   |
| canker     | 179개 (18.06%)  | 22개 (22.22%)   |
| greening   | 347개 (35.02%)  | 22개 (22.22%)   |
| 총 데이터 수 | 991개          | 99개           |

## 주요 연구 방법

* **데이터 전처리:**

    * VGG와 ResNet 모델의 입력 크기에 맞게 모든 이미지를 (224, 224) 크기로 조정했다.
    * 이미지 데이터를 텐서(tensor) 형태로 변환하여 모델 입력에 적합하도록 처리했다.
    * GPU 사용 시 연산 속도 향상을 위해 텐서 변환된 데이터를 캐싱 처리하고, 데이터 로더의 옵션을 설정했다.
* **모델 구성 및 미세 조정 (Fine-tuning):**

    * VGG11, VGG13, VGG16, VGG19 및 ResNet 계열 모델(ResNet18, ResNet34, ResNet50, ResNet101, ResNet152)을 사전 학습 모델로 사용했다.
    * 사전 학습 모델의 특징 추출 부분은 가중치를 동결(Freeze)하여 미세 조정 과정에서 변경되지 않도록 했다.
    * 각 모델의 분류기(Classifier) 부분을 오렌지 질병 분류에 맞게 재구성하고, 이 부분을 학습시켰다.
* **모델 학습 및 평가:**

    * 모델 학습 시 조기 종료(Early Stopping) 기법을 적용하여 과적합을 방지했다.
    * 학습 과정에서 손실값(Loss)을 모니터링하고, 검증 손실이 일정 기간 동안 개선되지 않으면 학습을 종료하도록 설정했다.
    * 모델의 성능은 정확도(Accuracy)와 손실값(Loss)을 사용하여 평가했다.
* **결과 분석 및 시각화:**

    * Confusion Matrix를 사용하여 모델의 클래스별 예측 결과를 시각화하고 분석했다.
    * 학습 과정에서의 손실값 및 정확도 변화를 그래프로 시각화하여 모델의 학습 과정을 분석했다.
* **실험 환경:**

    * Google Colab 환경에서 GPU를 사용하여 모델 학습 및 평가를 진행했다.
    * Pytorch를 사용하여 모델을 구현하고 학습 및 평가 과정을 진행했다.

## 주요 실험 결과

* **모델별 성능 비교:**

    * 기본 CNN 모델은 성능 변동성이 컸으나, 최고 94.95%의 정확도를 보였다.
    * VGG 모델 중에서는 VGG16이 97.98%로 가장 높은 정확도를 나타냈다.
    * ResNet 모델은 ResNet 101에서 98.99%, ResNet 50에서 96.97%의 높은 정확도를 보였다.
* **VGG vs ResNet:**

    * ResNet 101 모델이 VGG16에 비해 초기 및 최종 정확도가 모두 높았다.
    * VGG 모델은 ResNet 모델보다 Loss 값은 빠르게 감소했지만, 과적합 가능성이 있는 것으로 분석되었다.
* **클래스 예측 결과:**

    * 모델들은 canker와 blackspot 클래스를 혼동하는 경향을 보였다.
    * 정상 데이터를 질병 데이터로 잘못 예측하는 경우가 있었으나, 질병 데이터를 정상으로 잘못 예측하는 경우는 없었다.

## 결론 및 향후 연구 방향

* ResNet 101 모델이 가장 높은 분류 정확도를 보였다.
* ResNet 모델의 skip connection 구조가 깊은 네트워크 학습에 효과적인 것으로 분석된다.
* 향후 연구에서는 모델 효율성을 높이고, 최신 모델을 적용하여 성능을 개선할 수 있을 것이다.
* EfficientNet, GoogLeNet, ViT 등의 모델을 추가로 적용해 볼 수 있다.
* 데이터 불균형 해소 및 데이터 증강 기법을 통해 모델의 일반화 성능을 향상시키는 것도 중요하다.